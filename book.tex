% UTF-8 encoding
% Compile with latex+dvipdfmx, pdflatex, xelatex or lualatex
% XeLaTeX is recommanded
\documentclass[UTF8]{ctexbook}
\input{common}
%\input{macro_diary}

% Align section on the left
\makeatletter
\g@addto@macro{\CTEX@section@format}{\raggedright}
\makeatother

\title{\Huge 书籍模版}
\author{严超}
\date{2019}

\begin{document}
\maketitle
\newpage
\tableofcontents
\newpage

% 自动搜索子目录
\foreach \Year in {19,...,19} {  
  \foreach \Month in {1,...,12} {
    % I don't know how to check if a directory exists, so check the first file. 
    % The assumes the diary is not missing, esp 1.tex
    \IfFileExists{contents/\Year/\Month/1.tex}{
      \chapter{\Year-\Month}
      \foreach \Day in {1,...,31} {
        \IfFileExists{contents/\Year/\Month/\Day} {   
          \begin{diary}
            \input{contents/\Year/\Month/\Day}
          \end{diary} 
        }
      }  
    }  
  }
}

\end{document}
